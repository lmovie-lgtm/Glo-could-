<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Dashboard - Global Pilgrim Bank</title>
    <link rel="stylesheet" href="../css/style.css">
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>

<div class="dashboard">
    <div class="dashboard-header">
        <h1>üè¶ GLOBAL PILGRIM BANK</h1>
        <h2 id="customerName">Welcome, Customer</h2>
        <p style="color: #94a3b8; margin-bottom: 20px;">
            Account: <span id="accountNumber"></span> | 
            Serial: <span id="serialNumber"></span>
        </p>
        <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
            <button onclick="dailySync()" style="width: auto; padding: 10px 20px;">üîÑ Daily Sync ($5)</button>
            <button onclick="logout()" style="width: auto; padding: 10px 20px; background: linear-gradient(135deg, #ef4444, #dc2626);">Logout</button>
        </div>
    </div>

    <!-- Balance Cards -->
    <div class="balance-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 30px 0;">
        <div class="balance-card" style="background: linear-gradient(135deg, #16a34a, #22c55e); padding: 25px; border-radius: 10px; text-align: center;">
            <h3 style="color: white; font-size: 0.9rem;">NGN Balance</h3>
            <p id="balanceNGN" style="font-size: 1.8rem; margin: 10px 0; color: white;">‚Ç¶0.00</p>
        </div>
        <div class="balance-card" style="background: linear-gradient(135deg, #3b82f6, #2563eb); padding: 25px; border-radius: 10px; text-align: center;">
            <h3 style="color: white; font-size: 0.9rem;">USD Balance</h3>
            <p id="balanceUSD" style="font-size: 1.8rem; margin: 10px 0; color: white;">$0.00</p>
        </div>
        <div class="balance-card" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed); padding: 25px; border-radius: 10px; text-align: center;">
            <h3 style="color: white; font-size: 0.9rem;">EUR Balance</h3>
            <p id="balanceEUR" style="font-size: 1.8rem; margin: 10px 0; color: white;">‚Ç¨0.00</p>
        </div>
        <div class="balance-card" style="background: linear-gradient(135deg, #f59e0b, #d97706); padding: 25px; border-radius: 10px; text-align: center;">
            <h3 style="color: white; font-size: 0.9rem;">GBP Balance</h3>
            <p id="balanceGBP" style="font-size: 1.8rem; margin: 10px 0; color: white;">¬£0.00</p>
        </div>
        <div class="balance-card" style="background: linear-gradient(135deg, #ec4899, #db2777); padding: 25px; border-radius: 10px; text-align: center;">
            <h3 style="color: white; font-size: 0.9rem;">Profit Balance</h3>
            <p id="profitBalanceDisplay" style="font-size: 1.8rem; margin: 10px 0; color: white;">$0.00</p>
        </div>
    </div>

    <!-- Send Money Section -->
    <div class="section">
        <h2>üí∏ Send Money (Bank A ‚Üí Bank B Model)</h2>
        
        <div style="margin-bottom: 20px;">
            <label>Transfer Type</label>
            <select id="transferType" onchange="toggleTransferFields()">
                <option value="local">Local Transfer (Nigeria)</option>
                <option value="international">International Transfer (SWIFT)</option>
            </select>
        </div>

        <div id="localTransferFields">
            <label>Recipient Bank</label>
            <select id="recipientBank">
                <option value="GPB">Global Pilgrim Bank (Internal)</option>
                <option value="GTB">Guaranty Trust Bank (GTB)</option>
                <option value="FBN">First Bank of Nigeria (FBN)</option>
                <option value="UBA">United Bank for Africa (UBA)</option>
                <option value="Access">Access Bank</option>
                <option value="Zenith">Zenith Bank</option>
                <option value="Fidelity">Fidelity Bank</option>
                <option value="Wema">Wema Bank</option>
                <option value="OPay">OPay</option>
                <option value="PalmPay">PalmPay</option>
                <option value="Moniepoint">Moniepoint</option>
                <option value="Kuda">Kuda Bank</option>
                <option value="Sterling">Sterling Bank</option>
            </select>
        </div>

        <div id="internationalTransferFields" style="display: none;">
            <label>Recipient Bank</label>
            <input type="text" id="internationalBank" placeholder="Enter international bank name">
            <label>SWIFT/BIC Code</label>
            <input type="text" id="swiftCode" placeholder="Enter SWIFT code">
            <label>Recipient Country</label>
            <select id="recipientCountry">
                <option value="US">United States (USD)</option>
                <option value="UK">United Kingdom (GBP)</option>
                <option value="EU">Eurozone (EUR)</option>
                <option value="CH">Switzerland (CHF)</option>
                <option value="CA">Canada (CAD)</option>
                <option value="AU">Australia (AUD)</option>
                <option value="JP">Japan (JPY)</option>
                <option value="CN">China (CNY)</option>
            </select>
        </div>

        <label>Recipient Account Number</label>
        <input type="text" id="recipientAccount" placeholder="Enter recipient account number">

        <label>Recipient Name</label>
        <input type="text" id="recipientName" placeholder="Enter recipient full name">

        <label>Amount</label>
        <input type="number" id="sendAmount" placeholder="Enter amount to send">

        <label>Select Currency</label>
        <select id="sendCurrency">
            <option value="NGN">NGN (Naira)</option>
            <option value="USD">USD (Dollar)</option>
            <option value="EUR">EUR (Euro)</option>
            <option value="GBP">GBP (Pound)</option>
            <option value="CHF">CHF (Swiss Franc)</option>
        </select>

        <label>Description (Optional)</label>
        <input type="text" id="sendDescription" placeholder="Transaction description">

        <button onclick="sendMoney()" style="margin-top: 10px;">Send Money</button>
    </div>

    <!-- Receive Money Section -->
    <div class="section">
        <h2>üì• Receive Money</h2>
        
        <label>Sender Bank Name</label>
        <input type="text" id="senderBank" placeholder="Enter sender bank name">
        
        <label>Sender Account Number</label>
        <input type="text" id="senderAccount" placeholder="Enter sender account number">
        
        <label>Sender Name</label>
        <input type="text" id="senderName" placeholder="Enter sender full name">
        
        <label>Amount to Receive</label>
        <input type="number" id="receiveAmount" placeholder="Enter amount received">
        
        <label>Received Currency</label>
        <select id="receiveCurrency">
            <option value="NGN">NGN (Naira)</option>
            <option value="USD">USD (Dollar)</option>
            <option value="EUR">EUR (Euro)</option>
            <option value="GBP">GBP (Pound)</option>
            <option value="CHF">CHF (Swiss Franc)</option>
        </select>
        
        <label>Reference Number (Optional)</label>
        <input type="text" id="referenceNumber" placeholder="Transaction reference number">
        
        <label>Description (Optional)</label>
        <input type="text" id="receiveDescription" placeholder="Transaction description">
        
        <button onclick="receiveMoney()" style="margin-top: 10px;">Receive Money</button>
    </div>

    <!-- Withdrawal Section -->
    <div class="section">
        <h2>üí≥ Withdraw Funds</h2>
        
        <label>Withdraw From</label>
        <select id="withdrawType">
            <option value="main">Main Balance</option>
            <option value="profit">Profit Balance</option>
            <option value="robot_profit">Robot Trading Profit</option>
        </select>
        
        <label>Amount to Withdraw</label>
        <input type="number" id="withdrawAmount" placeholder="Enter withdrawal amount">
        
        <label>Withdrawal Currency</label>
        <select id="withdrawCurrency">
            <option value="NGN">NGN (Naira)</option>
            <option value="USD">USD (Dollar)</option>
            <option value="EUR">EUR (Euro)</option>
            <option value="GBP">GBP (Pound)</option>
        </select>
        
        <label>Beneficiary Name</label>
        <input type="text" id="beneficiaryName" placeholder="Enter beneficiary full name">
        
        <label>Beneficiary Account Number</label>
        <input type="text" id="beneficiaryAccount" placeholder="Enter beneficiary account number">
        
        <label>Beneficiary Bank</label>
        <input type="text" id="beneficiaryBank" placeholder="Enter beneficiary bank name">
        
        <label>SWIFT Code (for international)</label>
        <input type="text" id="withdrawSwiftCode" placeholder="Enter SWIFT code if international">
        
        <button onclick="withdrawFunds()" style="margin-top: 10px;">Withdraw Funds</button>
    </div>

    <!-- Virtual Cards Section -->
    <div class="section">
        <h2>üí≥ Virtual Cards</h2>
        <div id="virtualCardsList" style="margin-bottom: 20px;"></div>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
            <button onclick="requestVirtualCard('Visa')" style="width: auto; background: linear-gradient(135deg, #1a1f71, #0d47a1);">Request Visa Card</button>
            <button onclick="requestVirtualCard('Mastercard')" style="width: auto; background: linear-gradient(135deg, #eb001b, #f79e1b);">Request Mastercard</button>
            <button onclick="requestVirtualCard('Verve')" style="width: auto; background: linear-gradient(135deg, #16a34a, #22c55e);">Request Verve Card</button>
        </div>
    </div>

    <!-- Pilgrim Coin Section -->
    <div class="section">
        <h2>‚õèÔ∏è Pilgrim Coin Mining</h2>
        <div style="background: rgba(245, 158, 11, 0.1); padding: 20px; border-radius: 10px; border: 1px solid #f59e0b; margin-bottom: 20px;">
            <p style="color: #f59e0b; font-size: 1.1rem;"><strong>Pilgrim Coin (PGM)</strong> - $0.50 per coin</p>
            <p style="color: #94a3b8;">Mining Rate: 0.000002 PGM per cycle</p>
            <p style="color: #94a3b8;">Wallet: <span id="pilgrimWallet">Not Generated</span></p>
        </div>
        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
            <button onclick="generatePilgrimWallet()" style="width: auto;">Generate Wallet</button>
            <button onclick="minePilgrimCoin()" style="width: auto;">Mine PGM</button>
            <button onclick="robotTrade()" style="width: auto; background: linear-gradient(135deg, #8b5cf6, #7c3aed);">Robot Trade</button>
        </div>
    </div>

    <!-- Forex Trading Section -->
    <div class="section">
        <h2>üìä Forex Trading</h2>
        <p style="color: #94a3b8; margin-bottom: 15px;">Connected to MetaTrader 4/5 - Server: Single Personal Network (6G-001)</p>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
            <button onclick="startAutoTrading()" style="width: auto; background: linear-gradient(135deg, #16a34a, #22c55e);">Start Auto Trading</button>
            <button onclick="stopAutoTrading()" style="width: auto; background: linear-gradient(135deg, #ef4444, #dc2626);">Stop Auto Trading</button>
            <button onclick="viewForexBalance()" style="width: auto;">View Forex Balance</button>
        </div>
    </div>

    <!-- Transaction History -->
    <div class="section">
        <h2>üìä Transaction History</h2>
        <div style="overflow-x: auto;">
            <table id="customerTransactionTable">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Type</th>
                        <th>Amount</th>
                        <th>Currency</th>
                        <th>Description</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="customerTransactionBody">
                    <!-- Dynamic content -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Account Settings -->
    <div class="section">
        <h2>‚öôÔ∏è Account Settings</h2>
        <label>Change Login PIN</label>
        <input type="password" id="newPin" placeholder="Enter new 4-digit PIN" maxlength="4">
        <button onclick="changePin()" style="width: auto;">Update PIN</button>
    </div>
</div>

<script src="../js/customer.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    loadCustomerDashboard();
});

function logout() {
    localStorage.removeItem('currentCustomer');
    window.location.href = 'customer-login.html';
}

function toggleTransferFields() {
    const transferType = document.getElementById('transferType').value;
    const localFields = document.getElementById('localTransferFields');
    const internationalFields = document.getElementById('internationalTransferFields');
    
    if (transferType === 'local') {
        localFields.style.display = 'block';
        internationalFields.style.display = 'none';
    } else {
        localFields.style.display = 'none';
        internationalFields.style.display = 'block';
    }
}

function dailySync() {
    const lastSync = localStorage.getItem('customerLastSync');
    const today = new Date().toDateString();
    
    if (lastSync === today) {
        showToast('Already synced today. Come back tomorrow!', 'error');
        return;
    }
    
    const currentCustomer = JSON.parse(localStorage.getItem('currentCustomer'));
    if (!currentCustomer) {
        showToast('Session expired. Please login again.', 'error');
        return;
    }
    
    const customers = JSON.parse(localStorage.getItem('customers')) || [];
    const customerIndex = customers.findIndex(c => c.account === currentCustomer.account);
    
    if (customerIndex !== -1) {
        customers[customerIndex].balanceUSD += 5;
        customers[customerIndex].ledger.push({
            date: new Date().toISOString(),
            type: 'credit',
            amount: 5,
            currency: 'USD',
            description: 'Daily sync bonus'
        });
        
        localStorage.setItem('customers', JSON.stringify(customers));
        localStorage.setItem('customerLastSync', today);
        localStorage.setItem('currentCustomer', JSON.stringify(customers[customerIndex]));
        
        showToast('$5 sync bonus credited!', 'success');
        loadCustomerDashboard();
    }
}
</script>

</body>
</html>