<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Global Pilgrim Bank</title>
    <link rel="stylesheet" href="css/style.css">
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>

<div class="dashboard">
    <div class="dashboard-header">
        <h1>ğŸ¦ GLOBAL PILGRIM BANK - ADMIN TERMINAL</h1>
        <h2>Administrator: Olawale Abdul-Ganiyu Adeshina (Adegan95)</h2>
        <p style="color: #94a3b8; margin-bottom: 20px;">
            <span>ğŸ“ +2349030277275</span> | 
            <span>ğŸ“§ adegan95@gmail.com</span>
        </p>
        <button onclick="logout()" style="width: auto; padding: 10px 30px; background: linear-gradient(135deg, #ef4444, #dc2626);">Logout</button>
    </div>

    <!-- Dashboard Stats -->
    <div class="stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 30px 0;">
        <div class="stat-card" style="background: rgba(30, 41, 59, 0.8); padding: 20px; border-radius: 10px; border: 1px solid #16a34a;">
            <h3 style="color: #16a34a;">Total Customers</h3>
            <p id="total-customers" style="font-size: 2rem; margin: 10px 0;">0</p>
        </div>
        <div class="stat-card" style="background: rgba(30, 41, 59, 0.8); padding: 20px; border-radius: 10px; border: 1px solid #22c55e;">
            <h3 style="color: #22c55e;">Main Balance</h3>
            <p id="main-balance" style="font-size: 2rem; margin: 10px 0;">$0.00</p>
        </div>
        <div class="stat-card" style="background: rgba(30, 41, 59, 0.8); padding: 20px; border-radius: 10px; border: 1px solid #f59e0b;">
            <h3 style="color: #f59e0b;">Profit Balance</h3>
            <p id="profit-balance" style="font-size: 2rem; margin: 10px 0;">$0.00</p>
        </div>
        <div class="stat-card" style="background: rgba(30, 41, 59, 0.8); padding: 20px; border-radius: 10px; border: 1px solid #0ea5e9;">
            <h3 style="color: #0ea5e9;">Total Transactions</h3>
            <p id="total-transactions" style="font-size: 2rem; margin: 10px 0;">0</p>
        </div>
    </div>

    <!-- Signal Terminal -->
    <div class="section">
        <h2>ğŸ“¡ Signal Terminal</h2>
        <div id="adminTerminal" style="background: #0f172a; padding: 20px; border-radius: 10px; font-family: monospace; min-height: 400px; max-height: 600px; overflow-y: auto; color: #22c55e; border: 2px solid #8b5cf6;">
        </div>
        <div style="margin-top: 15px; display: flex; gap: 10px;">
            <button onclick="testAllBankConnections()" style="width: auto; padding: 12px 25px; background: linear-gradient(135deg, #8b5cf6, #7c3aed);">Test All Bank Connections</button>
            <button onclick="clearTerminal()" style="width: auto; padding: 12px 25px; background: linear-gradient(135deg, #64748b, #475569);">Clear Terminal</button>
        </div>
    </div>

    <!-- Bank Network Management -->
    <div class="section">
        <h2>ğŸ¦ Bank Network Management</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px;">
            <input type="text" id="newBankCode" placeholder="Bank Code (e.g., GTB, 058)">
            <input type="text" id="newBankName" placeholder="Bank Name (e.g., Guaranty Trust Bank)">
            <select id="newBankType">
                <option value="local">Local (Nigeria)</option>
                <option value="international">International</option>
            </select>
            <button onclick="addNewBankConnection()" style="width: auto;">Add Bank Connection</button>
        </div>
        <div id="bankConnectionsList" style="max-height: 300px; overflow-y: auto; background: rgba(15, 23, 42, 0.5); padding: 15px; border-radius: 8px;">
            <p style="color: #94a3b8;">No bank connections yet</p>
        </div>
    </div>

    <!-- Customer Management -->
    <div class="section">
        <h2>ğŸ‘¤ Create Customer Account</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
            <input type="text" id="custName" placeholder="Full Name">
            <input type="text" id="custPhone" placeholder="Phone Number">
            <input type="email" id="custEmail" placeholder="Email Address">
            <input type="text" id="custBVN" placeholder="BVN (Optional)">
            <input type="text" id="custNIN" placeholder="NIN (Optional)">
            <select id="accountType">
                <option value="commercial">Commercial</option>
                <option value="microfinance">Microfinance</option>
            </select>
        </div>
        <button onclick="createCustomer()" style="margin-top: 15px;">Create Customer Account</button>
    </div>

    <!-- Search Customer -->
    <div class="section">
        <h2>ğŸ” Search Customer</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
            <input type="text" id="searchInput" placeholder="Account Number / Name / Phone / 10-Digit Account">
            <button onclick="searchCustomer()">Search Customer</button>
        </div>
        <div id="searchResult" style="margin-top: 20px;"></div>
    </div>

    <!-- Transaction Management -->
    <div class="section">
        <h2>ğŸ’³ Credit / Debit Customer</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
            <input type="text" id="transAccount" placeholder="Account Number">
            <input type="number" id="transAmount" placeholder="Amount">
            <select id="transCurrency">
                <option value="NGN">NGN (Naira)</option>
                <option value="USD">USD (Dollar)</option>
                <option value="EUR">EUR (Euro)</option>
                <option value="GBP">GBP (Pound)</option>
                <option value="CHF">CHF (Swiss Franc)</option>
            </select>
            <select id="transType">
                <option value="credit">Credit</option>
                <option value="debit">Debit</option>
            </select>
        </div>
        <input type="text" id="transDesc" placeholder="Transaction Description (Optional)" style="margin-top: 15px;">
        <button onclick="processTransaction()" style="margin-top: 15px;">Execute Transaction</button>
    </div>

    <!-- Profit Transfer -->
    <div class="section">
        <h2>ğŸ’° Profit Management</h2>
        <p>Current Profit Balance: <strong id="profitBalanceDisplay">$0.00</strong></p>
        <button onclick="transferProfit()" style="width: auto; padding: 12px 30px;">Transfer Profit to Main Balance</button>
    </div>

    <!-- Pending Transfers -->
    <div class="section">
        <h2>â³ Pending Transfers</h2>
        <div id="pendingTransfersList" style="max-height: 400px; overflow-y: auto;">
            <p style="color: #94a3b8;">No pending transfers</p>
        </div>
    </div>

    <!-- Customer List -->
    <div class="section">
        <h2>ğŸ‘¥ Customer List</h2>
        <div style="overflow-x: auto;">
            <table id="customerTable">
                <thead>
                    <tr>
                        <th>Account No</th>
                        <th>10-Digit</th>
                        <th>Name</th>
                        <th>Phone</th>
                        <th>Balance</th>
                        <th>Type</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="customerTableBody">
                    <!-- Dynamic content -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Transaction History -->
    <div class="section">
        <h2>ğŸ“Š Transaction History</h2>
        <div style="overflow-x: auto;">
            <table id="transactionTable">
                <thead>
                    <tr>
                        <th>Transaction ID</th>
                        <th>Account</th>
                        <th>Type</th>
                        <th>Amount</th>
                        <th>Date</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="transactionTableBody">
                    <!-- Dynamic content -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Login Attempts -->
    <div class="section">
        <h2>ğŸš¨ Unauthorized Login Attempts</h2>
        <div id="attemptLogs" style="max-height: 300px; overflow-y: auto; background: rgba(0, 0, 0, 0.3); padding: 15px; border-radius: 8px;"></div>
    </div>
</div>

<script src="js/app.js"></script>
<script>
// Check admin authentication
document.addEventListener('DOMContentLoaded', function() {
    if (localStorage.getItem('admin') !== 'true') {
        alert('Access Denied. Unauthorized access attempt logged.');
        logUnauthorizedAttempt();
        window.location.href = 'admin-login.html';
    }
    
    // Update last login
    localStorage.setItem('adminLastLogin', new Date().toLocaleString());
    
    // Load dashboard data
    loadDashboard();
    loadAttempts();
    loadCustomers();
    loadTransactions();
    loadPendingTransfers();
});

function logout() {
    localStorage.removeItem('admin');
    window.location.href = 'index.html';
}

function clearTerminal() {
    const terminal = document.getElementById('adminTerminal');
    terminal.innerHTML = `
        <p style="color: #8b5cf6;">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</p>
        <p style="color: #22c55e;">ğŸ¦ GLOBAL PILGRIM BANK - ADMINISTRATOR TERMINAL</p>
        <p style="color: #8b5cf6;">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</p>
        <p>Owner: ${ADMIN_CONFIG.name}</p>
        <p>Bank Code: ${BANK_INFO.code}</p>
        <p>SWIFT: ${BANK_INFO.swift}</p>
        <p>Current Balance: $${localStorage.getItem('mainBalance')}</p>
        <p>Profit Balance: $${localStorage.getItem('profit')}</p>
        <p style="color: #8b5cf6;">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</p>
        <p>Terminal cleared at ${new Date().toLocaleString()}</p>
    `;
}

function loadPendingTransfers() {
    const pendingTransfers = JSON.parse(localStorage.getItem('pendingTransfers')) || [];
    const transfersDiv = document.getElementById('pendingTransfersList');
    
    if (pendingTransfers.length === 0) {
        transfersDiv.innerHTML = '<p style="color: #94a3b8;">No pending transfers</p>';
        return;
    }
    
    let transfersHTML = '';
    pendingTransfers.slice(-20).reverse().forEach(transfer => {
        const statusColor = transfer.status === 'completed' ? '#22c55e' : 
                           transfer.status === 'processing' ? '#f59e0b' : '#64748b';
        
        transfersHTML += `
            <div style="padding: 15px; margin-bottom: 10px; background: rgba(30, 41, 59, 0.5); border-radius: 8px; border-left: 3px solid ${statusColor};">
                <div style="display: flex; justify-content: space-between; align-items: start;">
                    <div>
                        <p style="color: #e2e8f0; font-weight: 600;">${transfer.type.replace('_', ' ')}</p>
                        <p style="color: #64748b; font-size: 0.85rem;">ID: ${transfer.id}</p>
                        <p style="color: #94a3b8; font-size: 0.9rem;">
                            ${transfer.sourceBank} â†’ ${transfer.destinationBank || transfer.beneficiaryBank}
                        </p>
                        <p style="color: #94a3b8; font-size: 0.85rem;">
                            ${transfer.recipientName || transfer.beneficiaryName || transfer.senderName}
                        </p>
                    </div>
                    <div style="text-align: right;">
                        <p style="color: ${statusColor}; font-weight: 600;">${transfer.status.toUpperCase()}</p>
                        <p style="color: #f59e0b; font-weight: 600;">${transfer.amount.toLocaleString()} ${transfer.currency}</p>
                        <p style="color: #94a3b8; font-size: 0.8rem;">${new Date(transfer.createdAt).toLocaleString()}</p>
                    </div>
                </div>
            </div>
        `;
    });
    
    transfersDiv.innerHTML = transfersHTML;
}

// Auto-refresh pending transfers every 5 seconds
setInterval(loadPendingTransfers, 5000);
</script>

</body>
</html>